apiVersion: api.cerbos.dev/v1
resourcePolicy:
  resource: "user"
  version: "default"
  importDerivedRoles:
    - user_roles
  constants:
    local:
      corporate_network_ip_range: 10.20.0.0/16
  rules:
    - actions: ['create','view']
      effect: EFFECT_ALLOW
      derivedRoles:
        - anonymous 

    - actions: ['create','update','delete','view']
      effect: EFFECT_ALLOW
      derivedRoles:
        - owner
    
    - actions: ['*']
      effect: EFFECT_ALLOW
      derivedRoles:
        - admin